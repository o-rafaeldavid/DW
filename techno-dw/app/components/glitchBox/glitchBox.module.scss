@use 'sass:list';

@mixin verdeMagenta($xv: 0px, $yv: 0px, $blurv: 0px, $xm: 0px, $ym: 0px, $blurm: 0px){
    box-shadow:
        rgb(0, 255, 0) $xv $yv $blurv,
        magenta $xm $ym $blurm;
}

@mixin createGlitchCutAnimation($id, $params){
    @keyframes glitchCut_#{$id}{
        0%, 14%{
            translate: list.nth($params, 1) list.nth($params, 2);
        }
        15%, 49%{
            translate: list.nth($params, 3) list.nth($params, 4);
        }
        50%, 99%{
            translate: list.nth($params, 5) list.nth($params, 6);
        }
        100%{
            translate: list.nth($params, 7) list.nth($params, 8);
        }
    }
}

$cutProps0:
    -1em, 3em,
    4em, -1em,
    -2em, 3em,
    3em, -3em
;

$cutProps1:
    3em, 2em,
    -1em, 1em,
    2em, 3em,
    -5em, 4em
;

@include createGlitchCutAnimation(0, $cutProps0);
@include createGlitchCutAnimation(1, $cutProps1);

$blurProps: 
    1em,
    0.2em,
    0.5em,
    -1em,
    1em
;

@keyframes glitchBlur{
    0%, 14%{
        @include verdeMagenta(
            list.nth($blurProps, 2), list.nth($blurProps, 2), list.nth($blurProps, 1),
            -1 * list.nth($blurProps, 2), -1 * list.nth($blurProps, 2), list.nth($blurProps, 1)
        );
    }
    15%, 49%{
        @include verdeMagenta(
            list.nth($blurProps, 3), list.nth($blurProps, 3), list.nth($blurProps, 1),
            -1 * list.nth($blurProps, 3), -1 * list.nth($blurProps, 3), list.nth($blurProps, 1)
        );
    }
    50%, 99%{
        @include verdeMagenta(
            list.nth($blurProps, 4), list.nth($blurProps, 4), list.nth($blurProps, 1),
            -1 * list.nth($blurProps, 4), -1 * list.nth($blurProps, 4), list.nth($blurProps, 1)
        );
    }
    100%{
        @include verdeMagenta(
            list.nth($blurProps, 5), list.nth($blurProps, 5), list.nth($blurProps, 1),
            -1 * list.nth($blurProps, 5), -1 * list.nth($blurProps, 5), list.nth($blurProps, 1)
        );
    }
}

.glitch{
    position: relative;
    width: fit-content;
    height: fit-content;

    @include verdeMagenta(
                list.nth($blurProps, 2),
                list.nth($blurProps, 2),
                list.nth($blurProps, 1),
    
                -1 * list.nth($blurProps, 2),
                -1 * list.nth($blurProps, 2),
                list.nth($blurProps, 1)
            );


    > section{
        width: 100%;
        height: 100%;
        position: absolute;
        top: 0; left: 0;
        opacity: 0;

        &:first-of-type{
            clip-path: polygon(
                0 0,
                100% 0,
                100% 40%,
                0 40%
            );
        }
        &:last-of-type{
            clip-path: polygon(
                0 60%,
                100% 60%,
                100% 1000%,
                0 100%
            );
        }
    }
}

.glitchIt{
    animation: glitchBlur 200ms infinite;
    > section{
        opacity: 1;

        &:first-of-type{
            animation:
                glitchBlur 200ms infinite,
                glitchCut_0 200ms infinite
            ;
        }
        &:last-of-type{
            animation:
                glitchBlur 200ms infinite,
                glitchCut_1 200ms infinite
            ;
        }
    }
}